{% extends "contracts/contract_base.html" %}
{% load i18n %}

{% block contract_content %}
<nav>
    <a href="{% url 'contract-contract-update' contract.id %}">
        <h6>{% trans "Contract Details" %}</h6>
    </a>
    <a href="{% url 'contract-contractinspection-list' contract.id %}">
        <h6>{% trans "Inspections" %}</h6>
    </a>
    <a class="selected">
        <h6>{% trans "Payments" %}</h6>
    </a>
    <a href="{% url 'contract-socialsafeguarddata-list' contract.id %}">
        <h6>{% trans "Social Safeguard" %}</h6>
    </a>
    <a href="{% url 'contract-contractdocument-list' contract.id %}">
        <h6>{% trans "Documents" %}</h6>
    </a>
</nav>

<div class="content">
    <div class="align-items-center d-flex justify-content-between title-header">
        <h5 class="title">{% trans "List of payments" %}</h5>
        <button class="btn btn-primary form-modal-link" type="button" data-method="POST">{% trans "Add" %}</button>
    </div>
    <table id="contract-payment-list-table" class="contracts-profile-table d-block table table-hover">
        <thead>
            <tr>
                <th></th>
                <th>{% trans "Payment Date" %}</th>
                <th>{% trans "Payment Value" %}</th>
                <th>{% trans "Donor" %}</th>
                <th>{% trans "Funding Source" %}</th>
                <th>{% trans "Destination" %}</th>
            </tr>
        </thead>
        <tbody>
            {% for payment in payment_list %}
            <tr>
                <td class="text-center">
                    <a class="image pencil form-modal-link" data-method="PUT" data-object="{{ payment.json }}"></a>
                    <span></span>
                    <a class="image delete delete-link" data-delete="/contracts/api/contractpayment/{{ payment.id }}/"></a>
                </td>
                <td>{{ payment.date }}</td>
                <td>{{ payment.value }}</td>
                <td>{{ payment.donor }}</td>
                <td>{{ payment.source }}</td>
                <td>{{ payment.destination }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<div class="payment-modal form-modal modal" tabindex="-1" role="dialog">
    <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h1 class="modal-title">{% trans "Save Payment" %}</h1>
                <span class="close image" data-dismiss="modal" aria-label="{% trans 'Close' %}" aria-hidden="true"></span>
            </div>
            <div class="modal-body">
                <form>
                    <section>
                        <div class="form-group">
                            <label>{% trans "Payment Date" %}</label>
                            <span class="required">*</span>
                            <small class="form-text text-muted">{% trans "Select payment date" %}</small>
                            <input id="payment-date" class="form-control" type="date" pattern="\d{4}-\d{2}-\d{2}" required>
                        </div>
                        <div class="form-group">
                            <label>{% trans "Payment Value" %}</label>
                            <span class="required">*</span>
                            <small class="form-text text-muted">{% trans "Enter total payment value" %}</small>
                            <input id="payment-value" class="form-control" type="number" min="0" placeholder="$100.000" required>
                        </div>
                        <div class="form-group">
                            <label>{% trans "Donor" %}</label>
                            <small class="form-text text-muted">{% trans "Choose donor from the list" %}</small>
                            <select id="payment-donor" class="form-control">
                                <option value="0" selected>{% trans "Select donor" %}</option>
                                {% for donor in payments_donor %}
                                <option value="{{ donor.id }}">{{ donor.name }}</option>
                                {% endfor %}
                            </select>
                        </div>
                        <div class="form-group">
                            <label>{% trans "Funding Source" %}</label>
                            <span class="required">*</span>
                            <small class="form-text text-muted">{% trans "Choose funding source from the list" %}</small>
                            <select id="payment-source" class="form-control">
                                {% for source in payments_funding_source %}
                                <option value="{{ source.id }}">{{ source.name }}</option>
                                {% endfor %}
                            </select>
                        </div>
                        <div class="form-group">
                            <label>{% trans "Destination" %}</label>
                            <span class="required">*</span>
                            <small class="form-text text-muted">{% trans "Choose from the list the recipient of the payment" %}</small>
                            <select id="payment-destination" class="form-control">
                                {% for company in payments_destination %}
                                <option value="{{ company.id }}">{{ company.name }}</option>
                                {% endfor %}
                            </select>
                        </div>
                    </section>
                    <div class="d-flex justify-content-end">
                        <span>[</span><span class="required">*</span><span>]: Mandatory</span>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <a data-dismiss="modal">{% trans "Cancel" %}</a>
                <button id="save-payment" type="button" class="btn btn-primary" data-id="{{ contract.id }}">{% trans "Save" %}</button>
            </div>
        </div>
    </div>
</div>

<div class="action-modal delete-modal modal" tabindex="-1" role="dialog">
    <div class="modal-dialog modal-dialog-centered modal-sm" role="document">
        <div class="modal-content">
            <div class="d-flex justify-content-center modal-header">
                <span class="alert stop image"></span>
                <span class="close image" data-dismiss="modal" aria-label="{% trans 'Close' %}"
                    aria-hidden="true"></span>
            </div>
            <div class="modal-body text-center">
                <h6>{% trans "Delete Payment" %}</h6>
                <p>{% trans "Are you sure you want to delete this payment?" %}</p>
            </div>
            <div class="d-flex justify-content-center modal-footer">
                <button type="button" class="btn btn-danger delete-item">{% trans "Delete" %}</button>
                <button type="button" class="btn btn-light" data-dismiss="modal">{% trans "Don't delete" %}</button>
            </div>
        </div>
    </div>
</div>
{% endblock %}
