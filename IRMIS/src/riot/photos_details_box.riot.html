<photos_details_box>
    <template if="{ !state.errors.length && !state.currentPhotosData }">
        <p class="small">{ window.gettext("Loading photos...") }</p>
    </template>
    <template if="{ !state.hidden }">
        <template if="{ state.errors.length }">
            <p class="small">{ window.gettext(state.errors[0]) }</p>
        </template>
        <div if="{ !state.errors.length && state.currentPhotosData }" class="text-center">
            <div if="{ state.photo1_show }">
                <img class="uploaded-photo" src="{ state.currentPhotosData[0].url }">
            </div>
            <template if="{ state.currentPhotosData.length > 1 }">
                <div if="{ state.photo2_show }">
                    <img class="uploaded-photo" src="{ state.currentPhotosData[1].url }">
                </div>
                <ul class="d-flex justify-content-center pagination">
                    <li onclick="{ showPhoto1 }">{ window.gettext("Previous") }</li>
                    <li class="{ state.photo1_show ? 'active' : '' }" onclick="{ showPhoto1 }">1</li>
                    <li class="{ state.photo2_show ? 'active' : '' }" onclick="{ showPhoto2 }">2</li>
                    <li onclick="{ showPhoto2 }">{ window.gettext("Next") }</li>
                </ul>
            </template>
        </div>
        <p if="{ state.photo1_show }">{ state.currentPhotosData[0].description }</p>
        <p if="{ state.photo2_show }">{ state.currentPhotosData[1].description }</p>
    </template>

    <script>
        export default {
            state: {
                hidden: true,
                errors: [],
                currentPhotosData: undefined,
                photo1_show: true,
                photo2_show: false,
                noDescription: window.gettext("No photo description provided"),
            },
            onMounted(props, state) {
                this.photosModalListener = (data) => {
                    if (data.detail.currentPhotosData == undefined) {
                        this.state.hidden = true;
                    }
                    else if (data.detail.currentPhotosData != []) {
                        this.state.currentPhotosData = data.detail.currentPhotosData;
                        this.state.hidden = false;
                    } else {
                        this.state.errors = ["No inventory photos to show"];
                        this.state.hidden = false;
                    }
                    this.update();
                };
                document.addEventListener("photos-details-modal.updateModalData", this.photosModalListener);

                this.photosHideData = () => {
                    this.state.hidden = true;
                    this.update();
                };
                document.addEventListener("photos-details-modal.hideData", this.photosHideData);
            },
            onUnmount(props, state) {
                document.removeEventListener("photos-details-modal.updateModalData", this.photosModalListener);
                document.removeEventListener("photos-details-modal.hideData", this.photosHideData);
            },
            showPhoto1(e) {
                e.preventDefault();
                this.state.photo1_show = true;
                this.state.photo2_show = false;
                this.update();
            },
            showPhoto2(e) {
                e.preventDefault();
                this.state.photo1_show = false;
                this.state.photo2_show = true;
                this.update();
            },
        }
    </script>
</photos_details_box>
