<edit_structure_details>
    <div class="content-wrapper">
        <h5>{ window.gettext("Asset Details") }</h5>

        <section>
            <div class="form-group">
                <label>{ window.gettext("Structure Code") }</label>
                <input
                    class="{ state.errors.code ? 'danger' : null } { state.code ? '' : 'inactive' } form-control"
                    type="text" maxlength="25" placeholder="DI-001" value="{ state.code }"
                    oninput="{ checkCode }">
                <small class="form-text text-muted">{ window.gettext("Enter the code of the structure") }</small>
                <div if="{ state.errors.code }" class="invalid-tooltip">
                    <ul>
                        <li>{ state.errors.code }.</li>
                    </ul>
                </div>
            </div>

            <div class="form-group">
                <label>{ window.gettext("Structure Name") }</label>
                <input
                    class="{ state.errors.name ? 'danger' : null } { state.name ? '' : 'inactive' } form-control"
                    type="text" maxlength="25" placeholder="Kuluhun" value="{ state.name }"
                    oninput="{ checkName }">
                <small class="form-text text-muted">{ window.gettext("Enter the name of the structure") }</small>
                <div if="{ state.errors.name }" class="invalid-tooltip">
                    <ul>
                        <li>{ state.errors.name }.</li>
                    </ul>
                </div>
            </div>

            <!-- Bridge-specific field -->
            <div if="{ props.assetType === 'BRDG' }">
                <div class="form-group">
                    <label>{ window.gettext("River Name") }</label>
                    <input
                        class="{ state.errors.riverName ? 'danger' : null } { state.riverName ? '' : 'inactive' } form-control"
                        type="text" maxlength="25" placeholder="Kuluhun" value="{ state.riverName }"
                        oninput="{ checkRiverName }">
                    <small class="form-text text-muted">
                        { window.gettext("Enter the name of the river where the structure is located") }</small>
                    <div if="{ state.errors.riverName }" class="invalid-tooltip">
                        <ul>
                            <li>{ state.errors.riverName }.</li>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="form-group">
                <label>{ window.gettext("Construction Year") }</label>
                <input
                    class="{ state.errors.constructionYear ? 'danger' : null } { state.constructionYear ? '' : 'inactive' } form-control"
                    type="number" maxlength="4" placeholder="1970" value="{ state.constructionYear }" min="0"
                    oninput="{ checkConstructionYear }">
                <small class="form-text text-muted">{ window.gettext("Enter structure's construction year") }</small>
                <div if="{ state.errors.constructionYear }" class="invalid-tooltip">
                    <ul>
                        <li>{ state.errors.constructionYear }.</li>
                    </ul>
                </div>
            </div>

            <div class="form-group">
                <label>{ window.gettext("Length (meters)") }</label>
                <input class="{ state.errors.length ? 'danger' : null } { state.length ? '' : 'inactive' } form-control"
                    type="number" maxlength="25" placeholder="6" value="{ state.length }" oninput="{ checkLength }">
                <small class="form-text text-muted">{ window.gettext("Enter the structure's length in meters") }</small>
                <div if="{ state.errors.length }" class="invalid-tooltip">
                    <ul>
                        <li>{ state.errors.length }.</li>
                    </ul>
                </div>
            </div>

            <div class="form-group">
                <label>{ window.gettext("Width (meters)") }</label>
                <input class="{ state.errors.width ? 'danger' : null } { state.width ? '' : 'inactive' } form-control"
                    type="number" maxlength="25" placeholder="6" value="{ state.width }" oninput="{ checkWidth }">
                <small class="form-text text-muted">{ window.gettext("Enter the structure's width in meters") }</small>
                <div if="{ state.errors.width }" class="invalid-tooltip">
                    <ul>
                        <li>{ state.errors.width }.</li>
                    </ul>
                </div>
            </div>

            <!-- Culvert-specific fields -->
            <div if="{ props.assetType === 'CULV' }">
                <div class="form-group">
                    <label>{ window.gettext("Height (meters)") }</label>
                    <input
                        class="{ state.errors.height ? 'danger' : null } { state.height ? '' : 'inactive' } form-control"
                        type="number" maxlength="25" placeholder="6" value="{ state.height }" oninput="{ checkHeight }">
                    <small class="form-text text-muted">
                        { window.gettext("Enter the structure's height in meters") }
                    </small>
                    <div if="{ state.errors.height }" class="invalid-tooltip">
                        <ul>
                            <li>{ state.errors.height }.</li>
                        </ul>
                    </div>
                </div>

                <div class="form-group">
                    <label>{ window.gettext("Number of cells") }</label>
                    <input
                        class="{ state.errors.structureCells ? 'danger' : null } { state.structureCells ? '' : 'inactive' } form-control"
                        type="number" maxlength="25" placeholder="2" value="{ state.structureCells }"
                        oninput="{ checkNumberCells }">
                    <small class="form-text text-muted">
                        { window.gettext("Enter the number of cells in the structure") }
                    </small>
                    <div if="{ state.errors.structureCells }" class="invalid-tooltip">
                        <ul>
                            <li>{ state.errors.structureCells }.</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Bridge-specific field -->
            <div if="{ props.assetType === 'BRDG' }">
                <div class="form-group">
                    <label>{ window.gettext("Number of spans") }</label>
                    <input
                        class="{ state.errors.numberSpans ? 'danger' : null } { state.numberSpans ? '' : 'inactive' } form-control"
                        type="number" maxlength="25" placeholder="1" value="{ state.numberSpans }"
                        oninput="{ checkNumberSpans }">
                    <small class="form-text text-muted">
                        { window.gettext("Enter the number of spans in the structure") }
                    </small>
                    <div if="{ state.errors.numberSpans }" class="invalid-tooltip">
                        <ul>
                            <li>{ state.errors.numberSpans }.</li>
                        </ul>
                    </div>
                </div>
                <div class="form-group">
                    <label>{ window.gettext("Span Length") }</label>
                    <input
                        class="{ state.errors.spanLength ? 'danger' : null } { state.spanLength ? '' : 'inactive' } form-control"
                        type="number" maxlength="25" placeholder="1" value="{ state.spanLength }"
                        oninput="{ checkSpanLength }">
                    <small class="form-text text-muted">
                        { window.gettext("Enter the span length for the structure") }
                    </small>
                    <div if="{ state.errors.spanLength }" class="invalid-tooltip">
                        <ul>
                            <li>{ state.errors.spanLength }.</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <div class="button-wrapper d-flex justify-content-end">
            <button class="btn btn-primary" onclick="{ save }" disabled="{ props.saving }">
                { window.gettext("Save and continue") }
            </button>
        </div>
    </div>

    <script>
        import Edit_Stop_Alert from "./edit_stop_alert.riot.html";

        export default {
            state: {
                canSave: false,
                errors: {},
            },
            components: {
                Edit_Stop_Alert
            },
            onBeforeMount(props, state) {
                state.loading = true;
                state.code = props.structure.code;
                state.name = props.structure.name;
                state.constructionYear = props.structure.getConstructionYear();
                state.length = props.structure.getLength();
                state.width = props.structure.getWidth();

                if (props.assetType === 'BRDG') {
                    state.riverName = props.structure.getRiverName();
                    state.numberSpans = props.structure.getNumberSpans();
                    state.spanLength = props.structure.getSpanLength();
                } else {
                    state.height = props.structure.getHeight();
                    state.numberCells = props.structure.getNumberCells();
                }
            },
            save(e) {
                this.props.parent.saveStructure();
            },
            checkCode(e) {
                this.state.code = e.currentTarget.value;
                this.props.structure.setStructureCode(this.state.code);
                this.update();
            },
            checkName(e) {
                this.state.name = e.currentTarget.value;
                this.props.structure.setStructureName(this.state.name);
                this.update();
            },
            checkRiverName(e) {
                this.state.riverName = e.currentTarget.value;
                this.props.structure.setRiverName(this.state.riverName);
                this.update();
            },
            checkConstructionYear(e) {
                this.state.constructionYear = e.currentTarget.value;
                this.props.structure.setConstructionYear(this.state.constructionYear);
                this.update();
            },
            checkLength(e) {
                this.state.length = e.currentTarget.value;
                this.props.structure.setLength(this.state.length);
                this.update();
            },
            checkWidth(e) {
                this.state.width = e.currentTarget.value;
                this.props.structure.setWidth(this.state.width);
                this.update();
            },
            checkHeight(e) {
                this.state.structureHeight = e.currentTarget.value;
                this.props.structure.setHeight(this.state.height);
                this.update();
            },
            checkNumberCells(e) {
                this.state.structureCells = e.currentTarget.value;
                this.props.structure.setNumberCells(this.state.numberCells);
                this.update();
            },
            checkNumberSpans(e) {
                this.state.numberSpans = e.currentTarget.value;
                this.props.structure.setNumberSpans(this.state.numberSpans);
                this.update();
            },
            checkSpanLength(e) {
                this.state.spanLength = e.currentTarget.value;
                this.props.structure.setSpanLength(this.state.spanLength);
                this.update();
            },
        }
    </script>
</edit_structure_details>
