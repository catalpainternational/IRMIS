<upload_photo>
    <div>
        <form action="/upload-target" class="dropzone">
            <div class="cloud-box">
                <div class="upload-cloud"></div>
                <div class="upload-instructions">{ window.gettext("Click to upload") }</div>
                <div>{ window.gettext("Maximum file size 500KB") }</div>
                <div>{ window.gettext("Accepted file formats: JPEG, GIF, PNG") }</div>
            </div>
        </form>
        <input
            class="{ state.errors.photo ? 'danger' : null } { state.photo ? '' : 'inactive' } form-control upload-text"
            type="text" maxlength="500" placeholder="Enter a description of the photo" value="{ state.photo }"
            oninput="{ checkPhotoText }">
        <div if="{state.errors.photo}" class="invalid-tooltip">
            <ul>
                <li>{ state.errors.photo }.</li>
            </ul>
        </div>
    </div>
    <script>
        import Dropzone from "dropzone";

        export default {
            state: {
                photo: '',
                errors: {},
            },
            onMounted(props, state) {
                Dropzone.autoDiscover = false;
                const myDropzone = new Dropzone(this.$('form'), {
                    url: "/file/post",
                    maxFilesize: 0.5, // MB
                    acceptedFiles: '.jpeg,.jpg,.gif,.png',
                    dictDefaultMessage: '',
                    dictInvalidFileType: 'Not a valid image, please submit a JPEG, GIF, or PNG',
                    accept: (file, done) => {
                        if (file.name == "image.jpg") {
                            done();
                        } else { 
                            done(); 
                        }
                    }
                });
            },
            checkPhotoText(e) {
                console.log(e.currentTarget.value)
            }
        }
    </script>
</upload_photo>
