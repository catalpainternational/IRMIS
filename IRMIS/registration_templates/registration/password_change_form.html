{% extends "base_registration.html" %}
{% load i18n %}

{% block registration %}
<h5>{% trans "Create a new password" %}</h5>

<ul class="hints text-center">
	<li>{% trans "Your password can't be too similar to your other personal information" %}.</li>
	<li>{% trans "Your password must contain at least 8 characters" %}.</li>
	<li>{% trans "Your password can't be a commonly used password" %}.</li>
	<li>{% trans "Your password can't be entirely numeric" %}.</li>
</ul>

<form method="post" action=".">
	{% csrf_token %}

	{% if form.non_field_errors %}
	<span class="danger text-center">{{ form.non_field_errors }}</span>
	{% endif %}

	<div class="form-group">
		{% if form.old_password.errors %}
		<span class="danger text-center">{{ form.old_password.errors }}</span>
		{% endif %}
		<label class="{% if form.old_password.errors %}danger{% endif %}" for="old-password">{% trans "Old password" %}</label>
		<input id="old-password" class="{% if form.old_password.errors %}danger{% else %}inactive{% endif %} form-control" autofocus required placeholder="{% trans 'Old password' %}" name="old_password" type="password" maxlength="254" onkeyup="highlight()">
	</div>
	<div class="form-group">
		{% if form.new_password1.errors or form.new_password2.errors %}
		<span class="danger text-center">{{ form.new_password1.errors }} {{ form.new_password2.errors }}</span>
		{% endif %}
		<label class="{% if form.new_password1.errors or form.new_password2.errors %}danger{% endif %}" for="new-password">{% trans "New password" %}</label>
		<input id="new-password" class="{% if form.new_password1.errors or form.new_password2.errors %}danger{% else %}inactive{% endif %} form-control" required placeholder="{% trans 'New password' %}" name="new_password1" type="password" maxlength="254" onkeyup="highlight()">
	</div>
	<div class="form-group">
		<label class="{% if form.new_password1.errors or form.new_password2.errors %}danger{% endif %}" for="new-password-confirmation">{% trans "New password confirmation" %}</label>
		<input id="new-password-confirmation" class="{% if form.new_password1.errors or form.new_password2.errors %}danger{% else %}inactive{% endif %} form-control" required placeholder="{% trans 'New password confirmation' %}" name="new_password2" type="password" maxlength="254" onkeyup="highlight()">
	</div>

	<div class="align-items-center d-flex justify-content-between">
		<a href="{% url 'login' %}">{% trans "Cancel" %}</a>
		<button id="submit" class="btn btn-inactive" type="submit">{% trans "Save changes" %}</button>
	</div>
</form>

<script>
    var old_password = document.getElementById('old-password');
    var new_password = document.getElementById('new-password');
    var new_password_confirmation = document.getElementById('new-password-confirmation');
    var submit = document.getElementById('submit');

    function highlight() {
        if (old_password.value) {
            old_password.labels.item(0).classList.remove('danger');
            old_password.classList.remove('danger', 'inactive');
        } else old_password.classList.add('inactive');
            if (new_password.value) {
                new_password.labels.item(0).classList.remove('danger');
                new_password.classList.remove('danger', 'inactive');
            } else new_password.classList.add('inactive');
            if (new_password_confirmation.value) {
                new_password_confirmation.labels.item(0).classList.remove('danger');
                new_password_confirmation.classList.remove('danger', 'inactive');
            } else new_password_confirmation.classList.add('inactive');
        if (old_password.value && new_password.value && new_password_confirmation.value) {
            submit.classList.remove('btn-inactive');
            submit.classList.add('btn-primary');
        } else {
            submit.classList.remove('btn-primary');
            submit.classList.add('btn-inactive');
        }
    }
</script>
{% endblock %}
